{"admin":{"listen":"localhost:2019"},"apps":{"http":{"servers":{"srv0":{"automatic_https":{"disable":true,"skip":["localhost"]},"listen":[":8080"],"logs":{"logger_names":{"localhost":"log0"}},"routes":[{"handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"headers","response":{"deferred":true,"delete":["Server"],"set":{"Referrer-Policy":["strict-origin-when-cross-origin"],"X-Content-Type-Options":["nosniff"],"X-Frame-Options":["DENY"],"X-Proxy":["Caddy"],"X-Xss-Protection":["1; mode=block"]}}},{"encodings":{"gzip":{}},"handler":"encode","prefer":["gzip"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"body":"Caddy is healthy","handler":"static_response","status_code":200}]}]}],"match":[{"path":["/caddy-health"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"reverse_proxy","headers":{"request":{"set":{"Connection":["{http.request.header.Connection}"],"Host":["{http.request.host}"],"Upgrade":["{http.request.header.Upgrade}"],"X-Forwarded-For":["{http.request.remote.host}"],"X-Forwarded-Host":["{http.request.host}"],"X-Forwarded-Proto":["{http.request.scheme}"],"X-Real-Ip":["{http.request.remote.host}"]}}},"health_checks":{"active":{"expect_status":200,"interval":10000000000,"timeout":5000000000,"uri":"/health"}},"load_balancing":{"selection_policy":{"policy":"ip_hash"}},"upstreams":[{"dial":"backend-1:4001"},{"dial":"backend-2:4002"},{"dial":"backend-3:4003"}]}]}]}],"match":[{"path":["/socket.io/*"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"reverse_proxy","headers":{"request":{"set":{"Host":["{http.request.host}"],"X-Forwarded-For":["{http.request.remote.host}"],"X-Forwarded-Proto":["{http.request.scheme}"],"X-Real-Ip":["{http.request.remote.host}"]}}},"health_checks":{"active":{"uri":"/health"}},"load_balancing":{"selection_policy":{"policy":"least_conn"}},"upstreams":[{"dial":"backend-1:4001"},{"dial":"backend-2:4002"},{"dial":"backend-3:4003"}]}]}]}],"match":[{"path":["/api-docs*"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"reverse_proxy","headers":{"request":{"set":{"Host":["{http.request.host}"],"X-Forwarded-For":["{http.request.remote.host}"],"X-Forwarded-Host":["{http.request.host}"],"X-Forwarded-Proto":["{http.request.scheme}"],"X-Real-Ip":["{http.request.remote.host}"]}}},"health_checks":{"active":{"expect_status":200,"interval":10000000000,"timeout":5000000000,"uri":"/health"},"passive":{"fail_duration":30000000000,"max_fails":3}},"load_balancing":{"selection_policy":{"policy":"least_conn"}},"upstreams":[{"dial":"backend-1:4001"},{"dial":"backend-2:4002"},{"dial":"backend-3:4003"}]}]}]}],"match":[{"path":["/graphql*"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"reverse_proxy","health_checks":{"active":{"expect_status":200,"interval":10000000000,"timeout":5000000000,"uri":"/health"},"passive":{"fail_duration":30000000000,"max_fails":3}},"load_balancing":{"selection_policy":{"policy":"least_conn"}},"upstreams":[{"dial":"backend-1:4001"},{"dial":"backend-2:4002"},{"dial":"backend-3:4003"}]}]}]}],"match":[{"path":["/health"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"reverse_proxy","headers":{"request":{"set":{"Host":["{http.request.host}"],"X-Forwarded-For":["{http.request.remote.host}"],"X-Forwarded-Host":["{http.request.host}"],"X-Forwarded-Port":["{server_port}"],"X-Forwarded-Proto":["{http.request.scheme}"],"X-Real-Ip":["{http.request.remote.host}"]}}},"health_checks":{"active":{"expect_status":200,"interval":10000000000,"timeout":5000000000,"uri":"/health"},"passive":{"fail_duration":30000000000,"max_fails":3}},"load_balancing":{"selection_policy":{"policy":"least_conn"}},"upstreams":[{"dial":"backend-1:4001"},{"dial":"backend-2:4002"},{"dial":"backend-3:4003"}]}]}]}],"match":[{"path":["/api/*"]}]},{"group":"group7","handle":[{"handler":"subroute","routes":[{"handle":[{"handler":"reverse_proxy","headers":{"request":{"set":{"Host":["{http.request.host}"],"X-Forwarded-For":["{http.request.remote.host}"],"X-Forwarded-Proto":["{http.request.scheme}"],"X-Real-Ip":["{http.request.remote.host}"]}}},"health_checks":{"active":{"uri":"/health"}},"load_balancing":{"selection_policy":{"policy":"least_conn"}},"upstreams":[{"dial":"backend-1:4001"},{"dial":"backend-2:4002"},{"dial":"backend-3:4003"}]}]}]}]}]}],"match":[{"host":["localhost"]}],"terminal":true}]}}}},"logging":{"logs":{"default":{"encoder":{"format":"json"},"exclude":["http.log.access.log0"],"level":"INFO","writer":{"filename":"/var/log/caddy/access.log","output":"file","roll_keep":10,"roll_size_mb":10}},"log0":{"encoder":{"format":"json"},"include":["http.log.access.log0"],"writer":{"filename":"/var/log/caddy/localhost.log","output":"file","roll_keep":10,"roll_size_mb":10}}}}}